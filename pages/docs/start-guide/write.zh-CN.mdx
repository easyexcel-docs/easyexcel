# Write Excel
### General data generation will not be repeated later.

```java
    private List<DemoData> data() {
        List<DemoData> list = ListUtils.newArrayList();
        for (int i = 0; i < 10; i++) {
            DemoData data = new DemoData();
            data.setString("字符串" + i);
            data.setDate(new Date());
            data.setDoubleData(0.56);
            list.add(data);
        }
        return list;
    }
```

## Sample code

DEMO code address: [https://github.com/alibaba/easyexcel/blob/master/easyexcel-test/src/test/java/com/alibaba/easyexcel/test/demo/write/WriteTest.java](https: //github.com/alibaba/easyexcel/blob/master/easyexcel-test/src/test/java/com/alibaba/easyexcel/test/demo/write/WriteTest.java)

## The simplest way to write

### excel example

![img](/image/quickstart/write/simpleWrite.png)

### The simplest object to write

```java
@Getter
@Setter
@EqualsAndHashCode
public class DemoData {
     @ExcelProperty("String title")
     private String string;
     @ExcelProperty("Date Title")
     private Date date;
     @ExcelProperty("Number Title")
     private Double doubleData;
     /**
      * Ignore this field
      */
     @ExcelIgnore
     private String ignore;
}
```

### Code

```java
     /**
      * The simplest way to write
      * <p>
      * 1. Create the entity object corresponding to excel. Refer to {@link DemoData}
      * <p>
      * 2. Just write directly
      */
     @Test
     public void simpleWrite() {
         // Note that simpleWrite can be used when the amount of data is small (within 5000, the specific situation depends on the actual situation). For large amounts of data, please refer to Repeat multiple writes

         // Writing method 1 JDK8+
         // since: 3.0.0-beta1
         String fileName = TestFileUtil.getPath() + "simpleWrite" + System.currentTimeMillis() + ".xlsx";
         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         // If you want to use 03 here, just pass in the excelType parameter
         EasyExcel.write(fileName, DemoData.class)
             .sheet("template")
             .doWrite(() -> {
                 // Query data by page
                 return data();
             });

         //Writing 2
         fileName = TestFileUtil.getPath() + "simpleWrite" + System.currentTimeMillis() + ".xlsx";
         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         // If you want to use 03 here, just pass in the excelType parameter
         EasyExcel.write(fileName, DemoData.class).sheet("template").doWrite(data());

         //Writing 3
         fileName = TestFileUtil.getPath() + "simpleWrite" + System.currentTimeMillis() + ".xlsx";
         // Here you need to specify which class to use for writing
         try (ExcelWriter excelWriter = EasyExcel.write(fileName, DemoData.class).build()) {
             WriteSheet writeSheet = EasyExcel.writerSheet("template").build();
             excelWriter.write(data(), writeSheet);
         }
     }
```

## Only export specified columns based on parameters

### excel example

![img](/image/quickstart/write/simpleWrite.png)

### Object

Reference: [The simplest object to write](#The simplest object to write)

### Code

```java
     /**
      * Only export specified columns according to parameters
      * <p>
      * 1. Create the entity object corresponding to excel. Refer to {@link DemoData}
      * <p>
      * 2. According to yourself or exclude the columns you need
      * <p>
      * 3. Just write directly
      *
      * @since 2.1.1
      */
     @Test
     public void excludeOrIncludeWrite() {
         String fileName = TestFileUtil.getPath() + "excludeOrIncludeWrite" + System.currentTimeMillis() + ".xlsx";
         // Here you need to pay attention to the use of ExcelProperty annotations. If you want to avoid empty columns, you need to add the order field instead of index. Order will ignore empty columns and then continue, while index will not ignore empty columns. Column is the number of columns.

         //According to the field passed in by the user, assuming we want to ignore date
         Set<String> excludeColumnFiledNames = new HashSet<String>();
         excludeColumnFiledNames.add("date");
         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         EasyExcel.write(fileName, DemoData.class).excludeColumnFiledNames(excludeColumnFiledNames).sheet("template")
             .doWrite(data());

         fileName = TestFileUtil.getPath() + "excludeOrIncludeWrite" + System.currentTimeMillis() + ".xlsx";
         // According to the fields passed in by the user, suppose we only need to export date
         Set<String> includeColumnFiledNames = new HashSet<String>();
         includeColumnFiledNames.add("date");
         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         EasyExcel.write(fileName, DemoData.class).includeColumnFiledNames(includeColumnFiledNames).sheet("template")
             .doWrite(data());
     }
```

## Specify the column to be written

### excel example

![img](/image/quickstart/write/indexWrite.png)

### Object

```java
@Getter
@Setter
@EqualsAndHashCode
public class IndexData {
     @ExcelProperty(value = "String title", index = 0)
     private String string;
     @ExcelProperty(value = "Date Title", index = 1)
     private Date date;
     /**
      * Setting 3 here will cause the second column to be empty
      */
     @ExcelProperty(value = "Number title", index = 3)
     private Double doubleData;
}
```

### Code

```java
     /**
      * Specify the column to be written
      * <p>1. Create the entity object corresponding to excel. Refer to {@link IndexData}
      * <p>2. Use the {@link ExcelProperty} annotation to specify the column to be written.
      * <p>3. Just write directly
      */
     @Test
     public void indexWrite() {
         String fileName = TestFileUtil.getPath() + "indexWrite" + System.currentTimeMillis() + ".xlsx";
         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         EasyExcel.write(fileName, IndexData.class).sheet("template").doWrite(data());
     }
```

## Complex header writing

### excel example

![img](/image/quickstart/write/complexHeadWrite.png)

### Object

```java
@Getter
@Setter
@EqualsAndHashCode
public class ComplexHeadData {
     @ExcelProperty({"Main Title", "String Title"})
     private String string;
     @ExcelProperty({"Main Title", "Date Title"})
     private Date date;
     @ExcelProperty({"Main title", "Number title"})
     private Double doubleData;
}
```

### Code

```java
     /**
      * Complex header writing
      * <p>1. Create the entity object corresponding to excel. Refer to {@link ComplexHeadData}
      * <p>2. Use {@link ExcelProperty} annotation to specify complex headers
      * <p>3. Just write directly
      */
     @Test
     public void complexHeadWrite() {
         String fileName = TestFileUtil.getPath() + "complexHeadWrite" + System.currentTimeMillis() + ".xlsx";
         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         EasyExcel.write(fileName, ComplexHeadData.class).sheet("template").doWrite(data());
     }
```

## Repeat multiple writes (write to single or multiple Sheets)

### excel example

![img](/image/quickstart/write/repeatedWrite.png)

### Object

Reference: [The simplest object to write](#The simplest object to write)

### Code

```java
     /**
      * Repeat multiple times to write
      * <p>
      * 1. Create the entity object corresponding to excel. Refer to {@link ComplexHeadData}
      * <p>
      * 2. Use the {@link ExcelProperty} annotation to specify complex headers
      * <p>
      * 3. Just call the secondary write directly
      */
     @Test
     public void repeatedWrite() {
         //Method 1: If written to the same sheet
         String fileName = TestFileUtil.getPath() + "repeatedWrite" + System.currentTimeMillis() + ".xlsx";
         // Here you need to specify which class to use for writing
         try (ExcelWriter excelWriter = EasyExcel.write(fileName, DemoData.class).build()) {
             // Note here that if the same sheet only needs to be created once
             WriteSheet writeSheet = EasyExcel.writerSheet("template").build();
             // Call write. I called it five times here. In actual use, it is based on the total number of pages in the database paging.
             for (int i = 0; i < 5; i++) {
                 //Page to the database to query data. Here you can go to the database to query the data of each page.
                 List<DemoData> data = data();
                 excelWriter.write(data, writeSheet);
             }
         }

         //Method 2: If the same object is written to different sheets
         fileName = TestFileUtil.getPath() + "repeatedWrite" + System.currentTimeMillis() + ".xlsx";
         // Specify the file here
         try (ExcelWriter excelWriter = EasyExcel.write(fileName, DemoData.class).build()) {
             // Call write. I called it five times here. In actual use, it is based on the total number of pages in the database paging. This will eventually be written into 5 sheets.
             for (int i = 0; i < 5; i++) {
                 // Create writeSheet every time. Note here that sheetNo must be specified and sheetName must be different.
                 WriteSheet writeSheet = EasyExcel.writerSheet(i, "template" + i).build();
                 //Page to the database to query data. Here you can go to the database to query the data of each page.
                 List<DemoData> data = data();
                 excelWriter.write(data, writeSheet);
             }
         }

         //Method 3 If you write to different sheets and different objects
         fileName = TestFileUtil.getPath() + "repeatedWrite" + System.currentTimeMillis() + ".xlsx";
         // Specify the file here
         try (ExcelWriter excelWriter = EasyExcel.write(fileName).build()) {
             // Call write. I called it five times here. In actual use, it is based on the total number of pages in the database paging. This will eventually be written into 5 sheets.
             for (int i = 0; i < 5; i++) {
                 // Create writeSheet every time. Note here that sheetNo must be specified and sheetName must be different. Note here that DemoData.class can be changed every time. I use the same class here for convenience.
                 // Actually it can keep changing
                 WriteSheet writeSheet = EasyExcel.writerSheet(i, "template" + i).head(DemoData.class).build();
                 //Page to the database to query data. Here you can go to the database to query the data of each page.
                 List<DemoData> data = data();
                 excelWriter.write(data, writeSheet);
             }
         }

     }
```

## Date, number or custom format conversion

### excel example

![img](/image/quickstart/write/converterWrite.png)

### Object

```java
@Getter
@Setter
@EqualsAndHashCode
public class ConverterData {
     /**
      * I want all strings to be preceded by the words "custom:"
      */
     @ExcelProperty(value = "String title", converter = CustomStringStringConverter.class)
     private String string;
     /**
      * I want to write to excel in the format of year, month and day
      */
     @DateTimeFormat("yyyy year MM month dd day HH hour mm minute ss second")
     @ExcelProperty("Date Title")
     private Date date;
     /**
      * I want to write to excel as a percentage
      */
     @NumberFormat("#.##%")
     @ExcelProperty(value = "Number title")
     private Double doubleData;
}
```

### Code

```java
     /**
      * Date, number or custom format conversion
      * <p>1. Create the entity object corresponding to excel. Refer to {@link ConverterData}
      * <p>2. Use {@link ExcelProperty} together with the annotations {@link DateTimeFormat}, {@link NumberFormat} or custom annotations
      * <p>3. Just write directly
      */
     @Test
     public void converterWrite() {
         String fileName = TestFileUtil.getPath() + "converterWrite" + System.currentTimeMillis() + ".xlsx";
         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         EasyExcel.write(fileName, ConverterData.class).sheet("template").doWrite(data());
     }
```

## Image export

### excel example

![img](/image/quickstart/write/imageWrite.png)

### Object

```java
@Getter
@Setter
@EqualsAndHashCode
@ContentRowHeight(100)
@ColumnWidth(100/8)
public class ImageDemoData {
     private File file;
     private InputStream inputStream;
     /**
      * If the string type must specify a converter, string will be converted to string by default.
      */
     @ExcelProperty(converter = StringImageConverter.class)
     private String string;
     private byte[] byteArray;
     /**
      * Export based on url
      *
      * @since 2.1.1
      */
     private URL url;

     /**
      * Export based on file and set the export location.
      *
      * @since 3.0.0-beta1
      */
     private WriteCellData<Void> writeCellDataFile;
}
```

### Code

```java
    /**
      * Picture export
      * <p>
      * 1. Create the entity object corresponding to excel. Refer to {@link ImageDemoData}
      * <p>
      * 2. Just write directly
      */
     @Test
     public void imageWrite() throws Exception {
         String fileName = TestFileUtil.getPath() + "imageWrite" + System.currentTimeMillis() + ".xlsx";

         // Please note here that all pictures will be placed in memory. There is currently no good solution. If there are a large number of pictures, it is recommended to choose 1 from 2:
         // 1. Upload the image to oss or other storage website: https://www.aliyun.com/product/oss, and then put the link directly
         // 2. Use: https://github.com/coobird/thumbnailator or other tools to compress images

         String imagePath = TestFileUtil.getPath() + "converter" + File.separator + "img.jpg";
         try (InputStream inputStream = FileUtils.openInputStream(new File(imagePath))) {
             List<ImageDemoData> list = ListUtils.newArrayList();
             ImageDemoData imageDemoData = new ImageDemoData();
             list.add(imageDemoData);
             //Put in five types of pictures. For actual use, you only need to choose one.
             imageDemoData.setByteArray(FileUtils.readFileToByteArray(new File(imagePath)));
             imageDemoData.setFile(new File(imagePath));
             imageDemoData.setString(imagePath);
             imageDemoData.setInputStream(inputStream);
             imageDemoData.setUrl(new URL(
                 "https://raw.githubusercontent.com/alibaba/easyexcel/master/src/test/resources/converter/img.jpg"));

             // Demo here
             // Additional text needs to be added
             // And you need to put 2 pictures
             //The first picture is on the left
             //The second one is to the right and will occupy additional cells behind it.
             WriteCellData<Void> writeCellData = new WriteCellData<>();
             imageDemoData.setWriteCellDataFile(writeCellData);
             // This can be set to EMPTY, which means no other data is needed.
             writeCellData.setType(CellDataTypeEnum.STRING);
             writeCellData.setStringValue("Put some extra text");

             //You can put multiple pictures
             List<ImageData> imageDataList = new ArrayList<>();
             ImageData imageData = new ImageData();
             imageDataList.add(imageData);
             writeCellData.setImageDataList(imageDataList);
             //Put in the binary image
             imageData.setImage(FileUtils.readFileToByteArray(new File(imagePath)));
             //Image type
             imageData.setImageType(ImageType.PICTURE_TYPE_PNG);
             // Top, right, bottom and left need to be left blank
             // This is similar to css margin
             // Actual measurement here cannot be set too large. After it exceeds the original size of the cell, it will prompt for repair when opened. No good solution has been found yet.
             imageData.setTop(5);
             imageData.setRight(40);
             imageData.setBottom(5);
             imageData.setLeft(5);

             //Put in the second image
             imageData = new ImageData();
             imageDataList.add(imageData);
             writeCellData.setImageDataList(imageDataList);
             imageData.setImage(FileUtils.readFileToByteArray(new File(imagePath)));
             imageData.setImageType(ImageType.PICTURE_TYPE_PNG);
             imageData.setTop(5);
             imageData.setRight(5);
             imageData.setBottom(5);
             imageData.setLeft(50);
             //Set the position of the picture. Assume that the current goal is to cover the current cell and the cell to the right of the current cell.
             // The starting point is 0 relative to the current cell. Of course, you don’t need to write it.
             imageData.setRelativeFirstRowIndex(0);
             imageData.setRelativeFirstColumnIndex(0);
             imageData.setRelativeLastRowIndex(0);
             // The first three do not need to be written. The following one needs to be written, that is, the end needs to be moved one cell to the right relative to the current cell.
             // In other words, this picture will cover the current cell and the following cell
             imageData.setRelativeLastColumnIndex(1);

             // data input
             EasyExcel.write(fileName, ImageDemoData.class).sheet().doWrite(list);
         }
     }
```

## Hyperlinks, notes, formulas, specifying the style of a single cell, multiple styles of a single cell

### excel example

![img](/image/quickstart/write/writeCellDataWrite.png)

### Object

```java
@Getter
@Setter
@EqualsAndHashCode
public class WriteCellDemoData {
    /**
      * Hyperlink
      *
      * @since 3.0.0-beta1
      */
     private WriteCellData<String> hyperlink;

     /**
      * Remark
      *
      * @since 3.0.0-beta1
      */
     private WriteCellData<String> commentData;

     /**
      *Formula
      *
      * @since 3.0.0-beta1
      */
     private WriteCellData<String> formulaData;

     /**
      * Specify the style of the cell. Of course, styles can also use annotations and other methods.
      *
      * @since 3.0.0-beta1
      */
     private WriteCellData<String> writeCellStyle;

     /**
      * Specify a cell to have multiple styles
      *
      * @since 3.0.0-beta1
      */
     private WriteCellData<String> richText;
}
```

### Code

```java
     /**
      * Hyperlinks, notes, formulas, specifying the style of a single cell, multiple styles of a single cell
      * <p>
      * 1. Create the entity object corresponding to excel. Refer to {@link WriteCellDemoData}
      * <p>
      * 2. Just write directly
      *
      * @since 3.0.0-beta1
      */
     @Test
     public void writeCellDataWrite() {
         String fileName = TestFileUtil.getPath() + "writeCellDataWrite" + System.currentTimeMillis() + ".xlsx";
         WriteCellDemoData writeCellDemoData = new WriteCellDemoData();

         //Set hyperlink
         WriteCellData<String> hyperlink = new WriteCellData<>("official website");
         writeCellDemoData.setHyperlink(hyperlink);
         HyperlinkData hyperlinkData = new HyperlinkData();
         hyperlink.setHyperlinkData(hyperlinkData);
         hyperlinkData.setAddress("https://github.com/alibaba/easyexcel");
         hyperlinkData.setHyperlinkType(HyperlinkType.URL);

         //Set notes
         WriteCellData<String> comment = new WriteCellData<>("Comment cell information");
         writeCellDemoData.setCommentData(comment);
         CommentData commentData = new CommentData();
         comment.setCommentData(commentData);
         commentData.setAuthor("Jiaju Zhuang");
         commentData.setRichTextStringData(new RichTextStringData("This is a comment"));
         //The default size of the note is based on the size of the cell. I want to adjust it to the size of 4 cells, so backward and downward each occupy an additional cell.
         commentData.setRelativeLastColumnIndex(1);
         commentData.setRelativeLastRowIndex(1);

         //Set formula
         WriteCellData<String> formula = new WriteCellData<>();
         writeCellDemoData.setFormulaData(formula);
         FormulaData formulaData = new FormulaData();
         formula.setFormulaData(formulaData);
         //Replace the first number in 123456789 with 2
         // This is just an example. If it really involves formulas, try to memorize the calculations as much as possible, and try not to use the formulas if possible.
         formulaData.setFormulaValue("REPLACE(123456789,1,1,2)");

         // Set the style of a single cell. Of course, if there are many styles, you can also use comments and other methods.
         WriteCellData<String> writeCellStyle = new WriteCellData<>("Cell Style");
         writeCellStyle.setType(CellDataTypeEnum.STRING);
         writeCellDemoData.setWriteCellStyle(writeCellStyle);
         WriteCellStyle writeCellStyleData = new WriteCellStyle();
         writeCellStyle.setWriteCellStyle(writeCellStyleData);
         // Here you need to specify FillPatternType as FillPatternType.SOLID_FOREGROUND, otherwise the background color cannot be displayed.
         writeCellStyleData.setFillPatternType(FillPatternType.SOLID_FOREGROUND);
         // background green
         writeCellStyleData.setFillForegroundColor(IndexedColors.GREEN.getIndex());

         //Set multiple styles for a single cell
         // You need to set inMomery=true here, otherwise it will not be able to display multiple styles of a single cell, so use it with caution
         WriteCellData<String> richTest = new WriteCellData<>();
         richTest.setType(CellDataTypeEnum.RICH_TEXT_STRING);
         writeCellDemoData.setRichText(richTest);
         RichTextStringData richTextStringData = new RichTextStringData();
         richTest.setRichTextStringDataValue(richTextStringData);
         richTextStringData.setTextString("red green default");
         //The first 2 characters are red
         WriteFont writeFont = new WriteFont();
         writeFont.setColor(IndexedColors.RED.getIndex());
         richTextStringData.applyFont(0, 2, writeFont);
         //The next 2 words are green
         writeFont = new WriteFont();
         writeFont.setColor(IndexedColors.GREEN.getIndex());
         richTextStringData.applyFont(2, 4, writeFont);

         List<WriteCellDemoData> data = new ArrayList<>();
         data.add(writeCellDemoData);
         EasyExcel.write(fileName, WriteCellDemoData.class).inMemory(true).sheet("template").doWrite(data);
     }
```

## Write according to template

### Template excel example

![img](/image/quickstart/read/demo.png)

### excel example

![img](/image/quickstart/write/templateWrite.png)

### Object

Reference: [The simplest object to write](#The simplest object to write)

### Code

```java
     /**
      *Write according to template
      * <p>1. Create the entity object corresponding to excel. Refer to {@link IndexData}
      * <p>2. Use the {@link ExcelProperty} annotation to specify the column to be written.
      * <p>3. Use withTemplate to write templates
      * <p>4. Just write directly
      */
     @Test
     public void templateWrite() {
         String templateFileName = TestFileUtil.getPath() + "demo" + File.separator + "demo.xlsx";
         String fileName = TestFileUtil.getPath() + "templateWrite" + System.currentTimeMillis() + ".xlsx";
         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         // It should be noted here that the template file of withTemplate will be fully stored in the memory, so try not to use it to append files. If the file template file is too large, it will cause OOM.
         // If you want to append to the file (it cannot be processed in one thread, you can refer to the demo of multiple writes in one thread). It is recommended to temporarily store it in the database or disk cache (ehcache) and then write it all at once.
         EasyExcel.write(fileName, DemoData.class).withTemplate(templateFileName).sheet().doWrite(data());
     }
```

## Column width, row height

### excel example

![img](/image/quickstart/write/widthAndHeightWrite.png)

### Object

```java
@Getter
@Setter
@EqualsAndHashCode
@ContentRowHeight(10)
@HeadRowHeight(20)
@ColumnWidth(25)
public class WidthAndHeightData {
     @ExcelProperty("String title")
     private String string;
     @ExcelProperty("Date Title")
     private Date date;
     /**
      * Width is 50
      */
     @ColumnWidth(50)
     @ExcelProperty("Number Title")
     private Double doubleData;
}
```

### Code

```java
     /**
      * Column width, row height
      * <p>1. Create the entity object corresponding to excel. Refer to {@link WidthAndHeightData}
      * <p>2. Use the annotations {@link ColumnWidth}, {@link HeadRowHeight}, {@link ContentRowHeight} to specify the width or height
      * <p>3. Just write directly
      */
     @Test
     public void widthAndHeightWrite() {
         String fileName = TestFileUtil.getPath() + "widthAndHeightWrite" + System.currentTimeMillis() + ".xlsx";
         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         EasyExcel.write(fileName, WidthAndHeightData.class).sheet("template").doWrite(data());
     }
```

## Annotation form custom style

### since

2.2.0-beta1

### excel example

![img](/image/quickstart/write/annotationStyleWrite.png)

### Object

```java
@Getter
@Setter
@EqualsAndHashCode
//Set the header background to red IndexedColors.RED.getIndex()
@HeadStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 10)
// Set the header font to 20
@HeadFontStyle(fontHeightInPoints = 20)
//Set the background of the content to green IndexedColors.GREEN.getIndex()
@ContentStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 17)
// Set the content font to 20
@ContentFontStyle(fontHeightInPoints = 20)
public class DemoStyleData {
     // Set the header background of the string to pink IndexedColors.PINK.getIndex()
     @HeadStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 14)
     // Set the header font of the string to 20
     @HeadFontStyle(fontHeightInPoints = 30)
     // Set the background of the string content to sky blue IndexedColors.SKY_BLUE.getIndex()
     @ContentStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 40)
     // Set the content font of the string to 20
     @ContentFontStyle(fontHeightInPoints = 30)
     @ExcelProperty("String title")
     private String string;
     @ExcelProperty("Date Title")
     private Date date;
     @ExcelProperty("Number Title")
     private Double doubleData;
}/**
  *Style data class
  *
  * @author Jiaju Zhuang
  **/
@Data
//Set the header background to red IndexedColors.RED.getIndex()
@HeadStyle(fillPatternType = FillPatternType.SOLID_FOREGROUND, fillForegroundColor = 10)
// Set the header font to 20
@HeadFontStyle(fontHeightInPoints = 20)
//Set the background of the content to green IndexedColors.GREEN.getIndex()
@ContentStyle(fillPatternType = FillPatternType.SOLID_FOREGROUND, fillForegroundColor = 17)
// Set the content font to 20
@ContentFontStyle(fontHeightInPoints = 20)
public class DemoStyleData {
     // Set the header background of the string to pink IndexedColors.PINK.getIndex()
     @HeadStyle(fillPatternType = FillPatternType.SOLID_FOREGROUND, fillForegroundColor = 14)
     // Set the header font of the string to 20
     @HeadFontStyle(fontHeightInPoints = 30)
     // Set the background of the string content to sky blue IndexedColors.SKY_BLUE.getIndex()
     @ContentStyle(fillPatternType = FillPatternType.SOLID_FOREGROUND, fillForegroundColor = 40)
     // Set the content font of the string to 20
     @ContentFontStyle(fontHeightInPoints = 30)
     @ExcelProperty("String title")
     private String string;
     @ExcelProperty("Date Title")
     private Date date;
     @ExcelProperty("Number Title")
     private Double doubleData;
}
```

### Code

```java
     /**
      * Custom style in annotation form
      * <p>
      * 1. Create the entity object corresponding to excel. Refer to {@link DemoStyleData}
      * <p>
      * 3. Just write directly
      *
      * @since 2.2.0-beta1
      */
     @Test
     public void annotationStyleWrite() {
         String fileName = TestFileUtil.getPath() + "annotationStyleWrite" + System.currentTimeMillis() + ".xlsx";
         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         EasyExcel.write(fileName, DemoStyleData.class).sheet("template").doWrite(data());
     }
```

## Custom style

### excel example

![img](/image/quickstart/write/styleWrite.png)

### Object

Reference: [The simplest object to write](#The simplest object to write)

### Code

```java
     /**
      * Interceptor form custom style
      * <p>
      * 1. Create the entity object corresponding to excel. Refer to {@link DemoData}
      * <p>
      * 2. Create a style policy and register it
      * <p>
      * 3. Just write directly
      */
     @Test
     public void handlerStyleWrite() {
         // Method 1 Use existing strategies Recommended
         // HorizontalCellStyleStrategy The style of each row is the same or every other row is the same
         // AbstractVerticalCellStyleStrategy The style of each column is the same. You need to call back each page yourself.
         String fileName = TestFileUtil.getPath() + "handlerStyleWrite" + System.currentTimeMillis() + ".xlsx";
         // Head strategy
         WriteCellStyle headWriteCellStyle = new WriteCellStyle();
         //Set the background to red
         headWriteCellStyle.setFillForegroundColor(IndexedColors.RED.getIndex());
         WriteFont headWriteFont = new WriteFont();
         headWriteFont.setFontHeightInPoints((short)20);
         headWriteCellStyle.setWriteFont(headWriteFont);
         // Content strategy
         WriteCellStyle contentWriteCellStyle = new WriteCellStyle();
         // Here you need to specify FillPatternType as FillPatternType.SOLID_FOREGROUND, otherwise the background color cannot be displayed. The header defaults to FillPatternType, so you don’t need to specify it.
         contentWriteCellStyle.setFillPatternType(FillPatternType.SOLID_FOREGROUND);
         // background green
         contentWriteCellStyle.setFillForegroundColor(IndexedColors.GREEN.getIndex());
         WriteFont contentWriteFont = new WriteFont();
         // font size
         contentWriteFont.setFontHeightInPoints((short)20);
         contentWriteCellStyle.setWriteFont(contentWriteFont);
         // This strategy is that the header is the style of the header and the content is the style of the content. Other strategies can be implemented by yourself.
         HorizontalCellStyleStrategy horizontalCellStyleStrategy =
             new HorizontalCellStyleStrategy(headWriteCellStyle, contentWriteCellStyle);

         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         EasyExcel.write(fileName, DemoData.class)
             .registerWriteHandler(horizontalCellStyleStrategy)
             .sheet("template")
             .doWrite(data());

         //Method 2: Write it entirely by yourself using easyexcel. Not recommended. Try to use existing strategies.
         // @since 3.0.0-beta2
         fileName = TestFileUtil.getPath() + "handlerStyleWrite" + System.currentTimeMillis() + ".xlsx";
         EasyExcel.write(fileName, DemoData.class)
             .registerWriteHandler(new CellWriteHandler() {
                 @Override
                 public void afterCellDispose(CellWriteHandlerContext context) {
                     //The current event will be called back after the data is set to the cell of poi
                     // Determine if it is not a header. If it is a fill situation, here will be == null, so use not true.
                     if (BooleanUtils.isNotTrue(context.getHead())) {
                         // first cell
                         // As long as it is not the header, there will definitely be data. Of course, in the case of fill, context.getCellDataList() may be required. This requires looking at the template, because a cell will have multiple WriteCellData
                         WriteCellData<?> cellData = context.getFirstCellData();
                         //Here you need to go to cellData to get the style
                         //A very important reason is that WriteCellStyle is bound to dataFormatData. To put it simply, for example, if you add DateTimeFormat
                         //, the dataFormatData in writeCellStyle has been changed. If you create a new WriteCellStyle yourself, the annotated style may be invalid.
                         // Then getOrCreateStyle is used to return a style. If it is empty, create one and return
                         WriteCellStyle writeCellStyle = cellData.getOrCreateStyle();
                         writeCellStyle.setFillForegroundColor(IndexedColors.RED.getIndex());
                         // Here you need to specify FillPatternType as FillPatternType.SOLID_FOREGROUND
                         writeCellStyle.setFillPatternType(FillPatternType.SOLID_FOREGROUND);

                         //The style is set in this way. There is a FillStyleCellWriteHandler behind it, which will set WriteCellStyle to the cell by default, so you don't have to worry about it.
                     }
                 }
             }).sheet("template")
             .doWrite(data());

         //Method 3: Use the poi style to write it entirely yourself. Not recommended.
         // @since 3.0.0-beta2
         // Pit 1: There is dataformat in style, which is used to format data, so setting it yourself may cause the formatting annotations to not take effect.
         // Pit 2: Don’t keep creating styles. Remember to cache them. You can create up to 60,000 styles and then they will die.
         fileName = TestFileUtil.getPath() + "handlerStyleWrite" + System.currentTimeMillis() + ".xlsx";
         EasyExcel.write(fileName, DemoData.class)
             .registerWriteHandler(new CellWriteHandler() {
                 @Override
                 public void afterCellDispose(CellWriteHandlerContext context) {
                     //The current event will be called back after the data is set to the cell of poi
                     // Determine if it is not a header. If it is a fill situation, here will be == null, so use not true.
                     if (BooleanUtils.isNotTrue(context.getHead())) {
                         Cell cell = context.getCell();
                         // Get poi's workbook
                         Workbook workbook = context.getWriteWorkbookHolder().getWorkbook();
                         //Be sure to remember here and find a way to cache it in a reusable place. A table can create up to 60,000 styles.
                         // Try to pass the same cellStyle to different cells
                         CellStyle cellStyle = workbook.createCellStyle();
                         cellStyle.setFillForegroundColor(IndexedColors.RED.getIndex());
                         // Here you need to specify FillPatternType as FillPatternType.SOLID_FOREGROUND
                         cellStyle.setFillPattern(FillPatternType.SOLID_FOREGROUND);
                         cell.setCellStyle(cellStyle);

                         // Since dataformat is not specified here, the format of the last displayed data may not be correct.

                         // Here we need to clear the style of WriteCellData, otherwise there is an interceptor FillSty behind it.leCellWriteHandler will set WriteCellStyle to
                         // Going inside the cell will cause your settings to be different.
                         context.getFirstCellData().setWriteCellStyle(null);
                     }
                 }
             }).sheet("template")
             .doWrite(data());
     }
```

## Merge Cells

### since

2.2.0-beta1

### excel example

![img](/image/quickstart/write/mergeWrite.png)

### Object

method 1

```java
@Getter
@Setter
@EqualsAndHashCode
// Combine columns 2-3 of rows 6-7 into one cell
// @OnceAbsoluteMerge(firstRowIndex = 5, lastRowIndex = 6, firstColumnIndex = 1, lastColumnIndex = 2)
public class DemoMergeData {
     // Merge cells every 2 rows in this column
     @ContentLoopMerge(eachRow = 2)
     @ExcelProperty("String title")
     private String string;
     @ExcelProperty("Date Title")
     private Date date;
     @ExcelProperty("Number Title")
     private Double doubleData;
}
```

Method 2 reference: [The simplest object to write](#The simplest object to write)

### Code

```java
    /**
      * Merge Cells
      * <p>
      * 1. Create the entity object corresponding to excel. Refer to {@link DemoData} {@link DemoMergeData}
      * <p>
      * 2. Create a merge strategy and register it
      * <p>
      * 3. Just write directly
      *
      * @since 2.2.0-beta1
      */
     @Test
     public void mergeWrite() {
         //Method 1 Annotations
         String fileName = TestFileUtil.getPath() + "mergeWrite" + System.currentTimeMillis() + ".xlsx";
         //Add ContentLoopMerge annotation to DemoStyleData
         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         EasyExcel.write(fileName, DemoMergeData.class).sheet("template").doWrite(data());

         //Method 2 Customize merge cell strategy
         fileName = TestFileUtil.getPath() + "mergeWrite" + System.currentTimeMillis() + ".xlsx";
         // Every 2 rows will be merged. Set eachColumn to 3, which is the length of our data, so the first column will be merged. Of course, you can also write other merge strategies yourself
         LoopMergeStrategy loopMergeStrategy = new LoopMergeStrategy(2, 0);
         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         EasyExcel.write(fileName, DemoData.class).registerWriteHandler(loopMergeStrategy).sheet("template").doWrite(data());
     }
```

## Use table to write

### excel example

![img](/image/quickstart/write/tableWrite.png)

### Object

Reference: [The simplest object to write](#The simplest object to write)

### Code

```java
     /**
      * Use table to write
      * <p>
      * 1. Create the entity object corresponding to excel. Refer to {@link DemoData}
      * <p>
      * 2. Then write it into the table
      */
     @Test
     public void tableWrite() {
         String fileName = TestFileUtil.getPath() + "tableWrite" + System.currentTimeMillis() + ".xlsx";
         //Method 1: Here we directly write the case of multiple tables. If there is only one, you can also do it with one line of code. Please refer to other cases.
         // Here you need to specify which class to use for writing
         try (ExcelWriter excelWriter = EasyExcel.write(fileName, DemoData.class).build()) {
             //Set the sheet to not require a header, otherwise the header of the sheet will be output. It looks like the first table has 2 headers.
             WriteSheet writeSheet = EasyExcel.writerSheet("template").needHead(Boolean.FALSE).build();
             // The required header must be specified here. The table will inherit the configuration of the sheet. It is not required if the sheet is configured. The table is also not required by default.
             WriteTable writeTable0 = EasyExcel.writerTable(0).needHead(Boolean.TRUE).build();
             WriteTable writeTable1 = EasyExcel.writerTable(1).needHead(Boolean.TRUE).build();
             // The first write will create a header
             excelWriter.write(data(), writeSheet, writeTable0);
             // The second write will also create a header, and then write data after the first time
             excelWriter.write(data(), writeSheet, writeTable1);
         }
     }
```

## Dynamic header, real-time generated header writing

### excel example

![img](/image/quickstart/write/dynamicHeadWrite.png)

### Object

Reference: [The simplest object to write](#The simplest object to write)

### Code

```java
    /**
     * 动态头，实时生成头写入
     * <p>
     * 思路是这样子的，先创建List<String>头格式的sheet仅仅写入头,然后通过table 不写入头的方式 去写入数据
     *
     * <p>
     * 1. 创建excel对应的实体对象 参照{@link DemoData}
     * <p>* 2. Then write it into the table
      */
     @Test
     public void dynamicHeadWrite() {
         String fileName = TestFileUtil.getPath() + "dynamicHeadWrite" + System.currentTimeMillis() + ".xlsx";
         EasyExcel.write(fileName)
             //Put dynamic header here
             .head(head()).sheet("template")
             // Of course, the data here can also be passed in using List<List<String>>
             .doWrite(data());
     }

     private List<List<String>> head() {
         List<List<String>> list = new ArrayList<List<String>>();
         List<String> head0 = new ArrayList<String>();
         head0.add("string" + System.currentTimeMillis());
         List<String> head1 = new ArrayList<String>();
         head1.add("number" + System.currentTimeMillis());
         List<String> head2 = new ArrayList<String>();
         head2.add("Date" + System.currentTimeMillis());
         list.add(head0);
         list.add(head1);
         list.add(head2);
         return list;
     }
```

## Automatic column width (not very precise)

### excel example

![img](/image/quickstart/write/longestMatchColumnWidthWrite.png)

### Object

```java
@Getter
@Setter
@EqualsAndHashCode
public class LongestMatchColumnWidthData {
     @ExcelProperty("String title")
     private String string;
     @ExcelProperty("The date title is very long. The date title is very long. The date title is very long.")
     private Date date;
     @ExcelProperty("number")
     private Double doubleData;
}
```

### 代码

```java
   /**
     * 自动列宽(不太精确)
     * <p>
     * 这个目前不是很好用，比如有数字就会导致换行。而且长度也不是刚好和实际长度一致。 所以需要精确到刚好列宽的慎用。 当然也可以自己参照
     * {@link LongestMatchColumnWidthStyleStrategy}重新实现.
     * <p>
     * poi 自带{@link SXSSFSheet#autoSizeColumn(int)} 对中文支持也不太好。目前没找到很好的算法。 有的话可以推荐下。
     *
     * <p>
     * 1. 创建excel对应的实体对象 参照{@link LongestMatchColumnWidthData}
     * <p>
     * 2. 注册策略{@link LongestMatchColumnWidthStyleStrategy}
     * <p>
     * 3. 直接写即可
     */
    @Test
    public void longestMatchColumnWidthWrite() {
        String fileName =
            TestFileUtil.getPath() + "longestMatchColumnWidthWrite" + System.currentTimeMillis() + ".xlsx";
        // 这里 需要指定写用哪个class去写，然后写到第一个sheet，名字为模板 然后文件流会自动关闭
        EasyExcel.write(fileName, LongestMatchColumnWidthData.class)
            .registerWriteHandler(new LongestMatchColumnWidthStyleStrategy()).sheet("模板").doWrite(dataLong());
    }
private List<LongestMatchColumnWidthData> dataLong() {
         List<LongestMatchColumnWidthData> list = new ArrayList<LongestMatchColumnWidthData>();
         for (int i = 0; i < 10; i++) {
             LongestMatchColumnWidthData data = new LongestMatchColumnWidthData();
             data.setString("Test a very long string. Test a very long string. Test a very long string" + i);
             data.setDate(new Date());
             data.setDoubleData(1000000000000.0);
             list.add(data);
         }
         return list;
     }
```

## Custom interceptor (if the above points are not met but you want to operate cells, please refer to this)

### excel example

![img](/image/quickstart/write/customHandlerWrite.png)

### Object

Reference: [The simplest object to write](#The simplest object to write)

### Define interceptor

```java
/**
  * Custom interceptor. Hyperlink to the header of the first row and first column: https://github.com/alibaba/easyexcel
  *
  * @author Jiaju Zhuang
  */
@Slf4j
public class CustomCellWriteHandler implements CellWriteHandler {

     @Override
     public void afterCellDispose(CellWriteHandlerContext context) {
         Cell cell = context.getCell();
         // Any operation can be performed on the cell here
         log.info("The writing of the {}th row, {}th column is completed.", cell.getRowIndex(), cell.getColumnIndex());
         if (BooleanUtils.isTrue(context.getHead()) && cell.getColumnIndex() == 0) {
             CreationHelper createHelper = context.getWriteSheetHolder().getSheet().getWorkbook().getCreationHelper();
             Hyperlink hyperlink = createHelper.createHyperlink(HyperlinkType.URL);
             hyperlink.setAddress("https://github.com/alibaba/easyexcel");
             cell.setHyperlink(hyperlink);
         }
     }

}
```

```java
/**
  * Custom interceptor. Add drop-down boxes for the data in the first and second rows of the first column to display Test 1 Test 2
  *
  * @author Jiaju Zhuang
  */
@Slf4j
public class CustomSheetWriteHandler implements SheetWriteHandler {

     @Override
     public void afterSheetCreate(SheetWriteHandlerContext context) {
         log.info("The {}th Sheet was written successfully.", context.getWriteSheetHolder().getSheetNo());

         //Interval setting: data in the first row and second row of the first column. Since the first row is the header, the data in the first and second rows are actually the second and third rows.
         CellRangeAddressList cellRangeAddressList = new CellRangeAddressList(1, 2, 0, 0);
         DataValidationHelper helper = context.getWriteSheetHolder().getSheet().getDataValidationHelper();
         DataValidationConstraint constraint = helper.createExplicitListConstraint(new String[] {"Test 1", "Test 2"});
         DataValidation dataValidation = helper.createValidation(constraint, cellRangeAddressList);
         context.getWriteSheetHolder().getSheet().addValidationData(dataValidation);
     }
}
```

### Code

```java
     /**
      * Custom interceptors such as drop-down and hyperlinks (if the above points are not met but you want to operate cells, please refer to this)
      * <p>
      *The demo implements 2 points here. 1. Hyperlink the header of the first row and the first column to: https://github.com/alibaba/easyexcel 2. Add a drop-down box for the data in the first row and the second row of the first column to display Test 1 Test 2
      * <p>
      * 1. Create the entity object corresponding to excel. Refer to {@link DemoData}
      * <p>
      * 2. Register interceptor {@link CustomCellWriteHandler} {@link CustomSheetWriteHandler}
      * <p>
      * 2. Just write directly
      */
     @Test
     public void customHandlerWrite() {
         String fileName = TestFileUtil.getPath() + "customHandlerWrite" + System.currentTimeMillis() + ".xlsx";
         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         EasyExcel.write(fileName, DemoData.class).registerWriteHandler(new CustomSheetWriteHandler())
             .registerWriteHandler(new CustomCellWriteHandler()).sheet("template").doWrite(data());
     }
```

## Insert comments

### excel example

![img](/image/quickstart/write/commentWrite.png)

### Object

Reference: [The simplest object to write](#The simplest object to write)

### Define interceptor

```java
/**
  * Custom interceptor. Add comments, add comments at the beginning of the first line
  *
  * @author Jiaju Zhuang
  */
@Slf4j
public class CommentWriteHandler implements RowWriteHandler {

     @Override
     public void afterRowDispose(RowWriteHandlerContext context) {
         if (BooleanUtils.isTrue(context.getHead())) {
             Sheet sheet = context.getWriteSheetHolder().getSheet();
             Drawing<?> drawingPatriarch = sheet.createDrawingPatriarch();
             //Create a comment in the first row and second column
             Comment comment =
                 drawingPatriarch.createCellComment(new XSSFClientAnchor(0, 0, 0, 0, (short)1, 0, (short)2, 1));
             //Enter comment information
             comment.setString(new XSSFRichTextString("Create comment!"));
             //Add the comment to the cell object
             sheet.getRow(0).getCell(1).setCellComment(comment);
         }
     }

}

```

### Code

```java
     /**
      * Insert comments
      * <p>
      * 1. Create the entity object corresponding to excel. Refer to {@link DemoData}
      * <p>
      * 2. Register interceptor {@link CommentWriteHandler}
      * <p>
      * 2. Just write directly
      */
     @Test
     public void commentWrite() {
         String fileName = TestFileUtil.getPath() + "commentWrite" + System.currentTimeMillis() + ".xlsx";
         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         // It should be noted here that inMemory must be set to true to support annotations. There is currently no good solution to not processing annotations in memory. You need to choose this yourself.
         EasyExcel.write(fileName, DemoData.class).inMemory(Boolean.TRUE).registerWriteHandler(new CommentWriteHandler())
             .sheet("template").doWrite(data());
     }
```

## Variable title processing (including title internationalization, etc.)

### excel example

![img](/image/quickstart/write/variableTitleWrite.png)

### Object

```java
@Getter
@Setter
@EqualsAndHashCode
public class ConverterData {
     /**
      * I want all strings to be preceded by the words "custom:"
      */
     @ExcelProperty(value = "String title", converter = CustomStringStringConverter.class)
     private String string;
     /**
      * I want to write to excel in the format of year, month and day
      */
     @DateTimeFormat("yyyy year MM month dd day HH hour mm minute ss second")
     @ExcelProperty("Date Title")
     private Date date;
     /**
      * I want to write to excel as a percentage
      */
     @NumberFormat("#.##%")
     @ExcelProperty(value = "Number title")
     private Double doubleData;
}
```

### Code

```java
     /**
      * Variable title processing (including title internationalization, etc.)
      * <p>
      * Simply use the title of List<List<String>>, but it also supports annotations.
      * <p>
      * 1. Create the entity object corresponding to excel. Refer to {@link ConverterData}
      * <p>
      * 2. Just write directly
      */
     @Test
     public void variableTitleWrite() {
         //Writing 1
         String fileName = TestFileUtil.getPath() + "variableTitleWrite" + System.currentTimeMillis() + ".xlsx";
         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         EasyExcel.write(fileName, ConverterData.class).head(variableTitleHead()).sheet("template").doWrite(data());
     }

     private List<List<String>> variableTitleHead() {
         List<List<String>> list = ListUtils.newArrayList();
         List<String> head0 = ListUtils.newArrayList();
         head0.add("string" + System.currentTimeMillis());
         List<String> head1 = ListUtils.newArrayList();
         head1.add("number" + System.currentTimeMillis());
         List<String> head2 = ListUtils.newArrayList();
         head2.add("date" + System.currentTimeMillis());
         list.add(head0);
         list.add(head1);
         list.add(head2);
         return list;
     } private List<List<String>> variableTitleHead() {
         List<List<String>> list = new ArrayList<>();
         List<String> head0 = new ArrayList<>();
         head0.add("string" + System.currentTimeMillis());
         List<String> head1 = new ArrayList<>();
         head1.add("number" + System.currentTimeMillis());
         List<String> head2 = new ArrayList<>();
         head2.add("date" + System.currentTimeMillis());
         list.add(head0);
         list.add(head1);
         list.add(head2);
         return list;
     }
```

## Write without creating an object

### excel example

![img](/image/quickstart/write/simpleWrite.png)

### Code

```java
     /**
      * Write without creating an object
      */
     @Test
     public void noModelWrite() {
         //Writing 1
         String fileName = TestFileUtil.getPath() + "noModelWrite" + System.currentTimeMillis() + ".xlsx";
         //Here, you need to specify which class to use for writing, and then write to the first sheet with the name template. Then the file stream will be automatically closed.
         EasyExcel.write(fileName).head(head()).sheet("template").doWrite(dataList());
     }

     private List<List<String>> head() {
         List<List<String>> list = ListUtils.newArrayList();
         List<String> head0 = ListUtils.newArrayList();
         head0.add("string" + System.currentTimeMillis());
         List<String> head1 = ListUtils.newArrayList();
         head1.add("number" + System.currentTimeMillis());
         List<String> head2 = ListUtils.newArrayList();
         head2.add("Date" + System.currentTimeMillis());
         list.add(head0);
         list.add(head1);
         list.add(head2);
         return list;
     }

     private List<List<Object>> dataList() {
         List<List<Object>> list = ListUtils.newArrayList();
         for (int i = 0; i < 10; i++) {
             List<Object> data = ListUtils.newArrayList();
             data.add("string" + i);
             data.add(0.56);
             data.add(new Date());
             list.add(data);
         }
         return list;
     }
```

## Writing in web

### Sample code

DEMO code address: [https://github.com/alibaba/easyexcel/blob/master/easyexcel-test/src/test/java/com/alibaba/easyexcel/test/demo/web/WebTest.java](https: //github.com/alibaba/easyexcel/blob/master/easyexcel-test/src/test/java/com/alibaba/easyexcel/test/demo/web/WebTest.java)

### Object

Reference: [The simplest object to write] (#The simplest object to write) The name has changed.

### Code

```java
     /**
      * File download (if failed, an Excel with partial data will be returned)
      * <p>
      * 1. Create the entity object corresponding to excel. Refer to {@link DownloadData}
      * <p>
      * 2. Set the returned parameters
      * <p>
      * 3. Write directly. Note here that the OutputStream will be automatically closed when finishing. Of course, it is not a big problem if you close the stream outside.
      */
     @GetMapping("download")
     public void download(HttpServletResponse response) throws IOException {
         // Note here. Some students reported that using swagger will cause various problems. Please use the browser directly or postman.
         response.setContentType("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");
         response.setCharacterEncoding("utf-8");
         // URLEncoder.encode here can prevent Chinese garbled characters. Of course, it has nothing to do with easyexcel.
         String fileName = URLEncoder.encode("Test", "UTF-8").replaceAll("\\+", "%20");
         response.setHeader("Content-disposition", "attachment;filename*=utf-8''" + fileName + ".xlsx");
         EasyExcel.write(response.getOutputStream(), DownloadData.class).sheet("template").doWrite(data());
     }
```

## Write in web and return json when failure

### since

2.1.1

### Object

Reference: [The simplest object to write] (#The simplest object to write) The name has changed.

### Code

```java
     /**
      * Return json when the file download fails (by default, an Excel with partial data will be returned)
      *
      * @since 2.1.1
      */
     @GetMapping("downloadFailedUsingJson")
     public void downloadFailedUsingJson(HttpServletResponse response) throws IOException {
         // Note here. Some students reported that using swagger will cause various problems. Please use the browser directly or postman.
         try {
             response.setContentType("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");
             response.setCharacterEncoding("utf-8");
             // URLEncoder.encode here can prevent Chinese garbled characters. Of course, it has nothing to do with easyexcel.
             String fileName = URLEncoder.encode("Test", "UTF-8").replaceAll("\\+", "%20");
             response.setHeader("Content-disposition", "attachment;filename*=utf-8''" + fileName + ".xlsx");
             // Here you need to set the stream not to be closed
             EasyExcel.write(response.getOutputStream(), DownloadData.class).autoCloseStream(Boolean.FALSE).sheet("template")
                 .doWrite(data());
         } catch (Exception e) {
             //Reset response
             response.reset();
             response.setContentType("application/json");
             response.setCharacterEncoding("utf-8");
             Map<String, String> map = MapUtils.newHashMap();
             map.put("status", "failure");
             map.put("message", "Failed to download file" + e.getMessage());
             response.getWriter().println(JSON.toJSONString(map));
         }
     }
```




